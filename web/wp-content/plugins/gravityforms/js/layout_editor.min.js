!function(G){G.fn.setGroupId=function(t){return this.attr("data-groupId",t),this.each(function(){var e=b(G(this));e&&(e.layoutGroupId=t)}),this},G.fn.setGridColumnSpan=function(t){return null===t?this.css("grid-column","auto / auto"):(this.css("grid-column","span {0}".format(t)),this.each(function(){if(G(this).hasClass("spacer")){var e=G(this).prev(".gfield");(r=b(e)).layoutSpacerGridColumnSpan=t}else(r=b(G(this)))&&(r.layoutGridColumnSpan=t)})),this;var r},G.fn.getGridColumnSpan=function(){var e=parseInt(this.css("gridColumnStart").split(" ")[1]);return isNaN(e)&&void 0!==y&&(e=y),e},String.prototype.format=function(){var r=arguments;return this.replace(/{(\d+)}/g,function(e,t){return void 0!==r[t]?r[t]:e})};var i,h=G("#form_editor_fields_container"),g=G(".gform_editor"),x=G("#gform_fields"),e=G("#no-fields"),o=G("#no-fields-drop"),p=G(".editor-sidebar"),c=G(".gfield-field-action"),a=M(),m=null,t=".add-buttons button",y=getComputedStyle(x[0])["grid-template-columns"].split(" ").length,S=y/4,w=null,n=!1;function d(e,t){var r='<li data-js-field-loading-placeholder><div class="dropzone__loader"><div class="dropzone__loader-item dropzone__loader-label"></div><div class="dropzone__loader-item dropzone__loader-content"></div></div></li>';void 0!==t?0===t?G("#gform_fields").prepend(r):G("#gform_fields").children().eq(t-1).after(r):G("#gform_fields").append(r),G("[data-js-field-loading-placeholder]").setGridColumnSpan(y),G("#form_editor_fields_container").addClass("dropzone-loader-visible"),u(G("[data-js-field-loading-placeholder]"),j(!1).data("target"),j(!1).data("where"))}function l(){G("#form_editor_fields_container").removeClass("dropzone-loader-visible"),G("[data-js-field-loading-placeholder]").remove()}function s(r){r.hasClass("ui-draggable")&&r.draggable("destroy").resizable("destroy"),r.draggable({helper:"clone",zIndex:999,handle:".gfield-drag",create:function(e,t){if(!C(G(this))){var r,i=G(this).attr("id").replace("field_",""),o=!!i&&GetFieldById(i);o&&o.layoutGroupId&&!g.hasClass("gform_legacy_markup")?r=o.layoutGroupId:I(G(this),!1)||(r=I()),G(this).setGroupId(r)}},start:function(e,t){x.addClass("dragging"),h.addClass("droppable"),(m=G(this)).addClass("placeholder")},drag:function(e,t){t.helper.width(m.width()).height(m.height()).setGridColumnSpan(null),helperLeft=gform.tools.isRtl()?t.position.left+t.helper.outerWidth():t.position.left,f(0,t,t.position.top,helperLeft)},stop:function(e,t){x.removeClass("dragging"),h.removeClass("droppable"),m.removeClass("placeholder"),M().removeClass("hovering"),j().data("target")&&u(m,j().data("target"),j().data("where")),j().remove(),t.helper.remove()}}).resizable({handles:"e, w",start:function(e,t){if("1"===gf_legacy.is_legacy)return r.resizable("option","minWidth",t.size.width),r.resizable("option","maxWidth",t.size.width),void alert(gf_vars.alertLegacyMode);w=null,x.addClass("resizing")},resize:function(e,t){if("1"!==gf_legacy.is_legacy){var r,i,o,n,a,d,l,s,f,u,h=x.outerWidth()/y,g=t.element,p=g.outerWidth(),c=Math.max(S,Math.round(p/h)),m=g.getGridColumnSpan(),v=z(I(g)),_=(i=g,1===(o=(o=v).not(".spacer")).length||o.last()[0]===i[0]),C=v.filter(".spacer"),b=_&&!C.length?null:g.next();null===w&&(w=1<v.length?m+(r=b?W(b):0):y),n=c,a=S,d=w-(1<v.length&&!_?S:0),c=Math.max(a,Math.min(d,n)),G().add(t.helper).add(t.element).css("width","auto").css("left","auto").setGridColumnSpan(c),b&&(r=w-c,b.css("width","auto").setGridColumnSpan(r)),c==y||c==w?A(C):_&&!C.length&&W(v)<y&&(s=I(l=g),f=1,u=G('<div class="spacer gfield"></div>').setGroupId(s).setGridColumnSpan(f),l.after(u))}},stop:function(){"1"!==gf_legacy.is_legacy&&x.removeClass("resizing")}})}function f(e,s,f,u){M().removeClass("hovering"),function(e,t){if(gform.tools.isRtl())r=x.offset().left;else var r=h.offset().left;var i=x.offset(),o=i.top-h.offset().top,n=i.left-r,a=c.outerWidth()||null,d=-o+a,l=-n+h.outerWidth()-p.outerWidth()-a,s=-o+h.outerHeight(),f=-n;return d<t&&t<s&&f<e&&e<l}(u,f)?f<0?j().css({top:-30,left:0,height:"4px",width:x.outerWidth()}).data({where:"top",target:M().first()}):f>x.outerHeight()?j().css({top:x.outerHeight()-14,left:0,height:"4px",width:x.outerWidth()}).data({where:"bottom",target:M().last()}):M().not(s.helper).not(this).each(function(){var e=G(this),t=e.position(),r={top:t.top,right:t.left+e.outerWidth(),bottom:t.top+e.outerHeight(),left:t.left};if(i=u,(o=f)<(n=r).bottom&&o>n.top&&i<n.right&&i>n.left){var i,o,n;e.addClass("hovering"),C(e)&&(t=(e=e.prev()).position(),a="right");var a=function(e,t,r,i,o){var n=r.left+i/2,a=r.right-i/2,d=r.top+o/5,l=r.bottom-o/5;{if(t>r.top&&t<d)return"top";if(t<r.bottom&&l<t)return"bottom";if(e>r.left&&e<n)return"left";if(e<r.right&&a<e)return"right"}return"center"}(u,f,r,e.outerWidth(),e.outerHeight()),d=z(I(e),!1).length>=y/S;I(e)===I(s.helper)&&(d=!1);var l=function(e,t){var r,i,o,n,a,d;if(n=I(t),d=I(e.helper),o=z(n),n===d)return!0;C(t)?t=(a=t).prev():C(t.next())&&!1!==o.index(t.next())&&(a=t.next());i=(r=a?a.getGridColumnSpan():null)?r:v(o)?y/(o.length+1):(r=t.getGridColumnSpan(),r/2);if(parseInt(i)<3)return!1}(s,e);if("left"===a||"right"===a){if(!function(e,t){if(g.hasClass("gform_legacy_markup"))return;if(e.hasClass("gpage")||e.hasClass("gsection")||e.hasClass("gform_hidden"))return;if(t.hasClass("gpage")||t.hasClass("gsection")||t.hasClass("gform_hidden")||"hidden"===t.data("type"))return;if(t.is("button")&&-1!==G.inArray(t.val().toLowerCase(),["page","section"]))return;return 1}(e,m))return;if(d||!1===l)return}switch(j().data({where:a,target:e}),a){case"left":return j().css({top:t.top,left:t.left-10,height:e.outerHeight(),width:"4px"}),!1;case"right":return j().css({top:t.top,left:t.left+e.outerWidth()+6,right:"auto",height:e.outerHeight(),width:"4px"}),!1;case"bottom":return j().css({top:t.top+e.outerHeight()+26,left:0,height:"4px",width:"100%"}),!1;case"top":return j().css({top:t.top-30,left:0,height:"4px",width:"100%"}),!1}}}):j(!1).remove()}function u(e,t,r){if(t){var i,o,n,a,d,l,s,f;l=I(e),n=z(d=I(t)),C(t)?t=(f=t).prev():(C(t.next())||0<t.next().filter("[data-js-field-loading-placeholder]").length)&&!1!==n.index(t.next())&&(f=t.next()),s="left"===r||"right"===r,f&&s&&(i=f.getGridColumnSpan(),A(f),n=z(d)),"top"==r?t=n.first():"bottom"==r&&(t=n.last());var u=gform.tools.isRtl()?"right":"left";if("top"==r||r==u?e.insertBefore(t):e.insertAfter(t),s)if(i?(a=e,o=i):a=v(n)?(o=y/(n.length+1),n.add(e)):(o=(i=t.getGridColumnSpan())/2,t.add(e)),parseInt(o)==o)a.setGridColumnSpan(o);else{var h=Math.floor(o),g=Math.ceil(o);e.setGridColumnSpan(h),t.setGridColumnSpan(g)}else d=I(),e.setGridColumnSpan(y);e.setGroupId(d),_(l)}}function I(e,t){var r;return void 0!==e&&(r=e.attr("data-groupId")),r||!t&&void 0!==t||(r="xxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)})),r}function z(e,t){return t||void 0===t?M().filter('[data-groupId="{0}"]'.format(e)).not(".ui-draggable-dragging"):M().filter('[data-groupId="{0}"]'.format(e)).not(".ui-draggable-dragging").not(".spacer")}function W(e){var t=0;return e.each(function(){t+=G(this).getGridColumnSpan()}),t}function v(e){var t=e.first().getGridColumnSpan(),r=!0;return e.each(function(){if(G(this).getGridColumnSpan()!==t)return r=!1}),r}function _(e){var t=z(e),r=y/t.length,i=t.filter(".spacer");t[0]===i[0]&&0<t.length&&A(i),t.setGridColumnSpan(r)}function A(e){e.setGridColumnSpan(0).remove()}function C(e){return 0<e.filter(".spacer").length}function b(e){var t=e.attr("id"),r=!(!t||-1===t.indexOf("field_"))&&String(t).replace("field_","");return!!r&&GetFieldById(r)}function H(e){return StartAddField(e,Math.max(0,x.children().index(m)))}function r(){M().removeClass("field_selected"),G(".sidebar").tabs("option","active",0),HideSettings()}function M(){return x.find(".gfield")}function j(e){e=void 0===e;var t=G("#indicator");return!t.length&&e&&(t=G('<div id="indicator"></div>'),x.append(t)),t}s(a),function(){if("1"===window.gf_legacy.is_legacy||!a.length)return;var e=function(){var e=[],t=[],r=a[0].offsetTop;return a.each(function(){r===this.offsetTop||t.length&&(e.push(t),t=[]),t.push({el:this,groupId:this.dataset.groupid}),r=this.offsetTop}),e}(),n=[];e.forEach(function(e){var t,r,i=[],o=!1;e.forEach(function(e){-1!==n.indexOf(e.groupId)&&(o=!0),i.push(e.groupId)}),i.every(function(e,t,r){return e===r[0]})&&!o||(t=e,r=I(),t.forEach(function(e){G(e.el).setGroupId(r)})),n.push(e[0].groupId)})}(),G(t).on("mousedown touchstart",function(){G(this).attr("title","")}).draggable({helper:"clone",revert:function(){return!1},cancel:!1,appendTo:x,containment:"document",start:function(e,t){if(r(),h.addClass("droppable"),1==gf_vars.currentlyAddingField)return!1;t.helper.width(G(this).width()).height(G(this).height()),x.addClass("dragging"),(m=G(this).clone()).addClass("placeholder"),G(this).addClass("fieldPlaceholder")},drag:function(e,t){if(form.fields.length){var r=+t.position.top+t.helper.outerHeight()/2,i=+t.position.left+t.helper.outerWidth()/2;f(0,t,r,i)}},stop:function(e,t){G(this).removeClass("fieldPlaceholder"),h.removeClass("droppable"),x.removeClass("dragging");var r=!1;!form.fields.length&&n?(n=!1,r=H(t.helper.data("type"))):form.fields.length&&j(!1).data("target")&&(r=H(t.helper.data("type"))),r||(j(!1).remove(),m.remove(),m=null),G(this).attr("title",G(this).attr("data-description"))}}).on("click keypress",function(){m=null}),e.droppable({accept:t,activate:function(e,t){o.show(),G(this).addClass("ready")},over:function(){G(this).addClass("hovering"),o.addClass("hovering")},out:function(){G(this).removeClass("hovering"),o.removeClass("hovering")},drop:function(){n=!0,G(this).removeClass("hovering"),o.removeClass("hovering")},deactivate:function(){G(this).removeClass("ready")}}),h.on("click",function(){r()}),G(document).on("gform_field_added",function(e,t,r){var i=G("#field_"+r.id);null===m?i.setGroupId(I()):(u(i,j().data("target"),j().data("where")),m.remove(),m=null),h.hasClass("form_editor_fields_no_fields")&&(h.hasClass("form_editor_no_conflict")||gform.simplebar.initializeInstance(h[0]),setTimeout(function(){o.hide(),h.removeClass("form_editor_fields_no_fields")},200)),j().remove(),s(i)}),G(document).on("gform_field_deleted",function(e,t,r){i=I(G("#field_"+r))}),gform.addAction("gform_after_field_removed",function(e,t){_(i)}),gform.addAction("gform_field_duplicated",function(e,t,r,i){z(I(G("#field_"+i))).last().after(r),r.setGridColumnSpan(y).setGroupId(I()),s(r)}),gform.addAction("gform_after_refresh_field_preview",function(e){s(G("#field_"+e))}),gform.addAction("gform_before_get_field_markup",function(e,t,r){d(0,r)}),gform.addAction("gform_after_get_field_markup",function(e,t,r){l()}),gform.addAction("gform_before_field_duplicated",function(e){var t=G("#field_"+e);d(0,x.children().index(t)+1)}),gform.addAction("gform_field_duplicated",function(){l()}),gform.addAction("gform_before_refresh_field_preview",function(e){jQuery("#field_"+e).addClass("loading")}),gform.addAction("gform_after_refresh_field_preview",function(e){jQuery("#field_"+e).removeClass("loading")})}(jQuery);